<!DOCTYPE html>
<!-- saved from url=(0025)https://www.sunrisemc.tw/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>日出伺服器｜Minecraft伺服器｜生存｜紅石</title>
    <link rel="icon" type="image/png" href="./source/favicon.png">
    <link rel="stylesheet" href="./source/style.css">
    <link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>
    <script src="./source/jquery.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Background Interactive Elements -->
    <div class="background-interactive" id="backgroundInteractive">
        <div class="tech-grid"></div>
        <div class="energy-ring" style="top: 20%; left: 10%; width: 100px; height: 100px;"></div>
        <div class="energy-ring" style="top: 60%; right: 15%; width: 150px; height: 150px;"></div>
        <div class="energy-ring" style="bottom: 20%; left: 20%; width: 80px; height: 80px;"></div>
        <div class="holographic-line" style="top: 30%; width: 100%;"></div>
        <div class="holographic-line" style="top: 70%; width: 100%;"></div>
        <div class="mouse-follower" id="mouseFollower"></div>

    </div>
    <nav class="desktop_navbar">
      <a href="#"><img class="desktop_navbar_logo_img" src="./source/favicon.png" alt="logo"></a>
      <a href="https://wiki.sunrisemc.tw/" class="desktop_navbar_link" target="_blank"><i class="fa-solid fa-circle-info fa-fw"></i> Wiki</a>
      <a href="https://discord.gg/3uEMfvv4d5" class="desktop_navbar_link" target="_blank"><i class="fa-brands fa-discord fa-fw"></i> Discord</a>
      <a href="https://map.sunrisemc.tw/" class="desktop_navbar_link" target="_blank"><i class="fa-solid fa-location-dot fa-fw"></i> 地圖</a>
      <a href="https://status.sunrisemc.tw/" class="desktop_navbar_link" target="_blank"><i class="fa-solid fa-toggle-on fa-fw"></i> 系統狀態</a>
      <a href="#about" class="desktop_navbar_link scroll"><i class="fa-solid fa-user-nurse"></i> 成員</a>
      <div>
        <a href="#join" class="desktop_navbar_link2_div desktop_navbar_link2 scroll"> <i class="fa-solid fa-rocket"></i> 立即加入！</a>
      </div>
        <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">
          <i class="fa-solid fa-sun sun-icon"></i>
          <i class="fa-solid fa-moon moon-icon"></i>
        </button>
        
        <!-- 音量控制容器 -->
        <div class="volume-control-container">
          <button class="volume-toggle" id="volumeToggle">
            <i class="fa-solid fa-volume-high" id="volumeIcon"></i>
          </button>
          <!-- 直接顯示在導航欄中的音量控制條 -->
          <div class="volume-slider-wrapper" id="volumeSliderWrapper">
            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="50">
          </div>
        </div>

        <div class="user-container">
          <button class="avator" id="useravator">
            <img src="./source/loading.gif" alt="圖片" class="avator-img">
          </button>
          <!-- 桌面版用戶下拉選單 -->
          <div class="user-dropdown" id="userDropdown">
            <div class="dropdown-item" onclick="showProfile()">
              <i class="fa-solid fa-user"></i>
              <span>基本資料</span>
            </div>
            <div class="dropdown-item" onclick="showDonations()">
              <i class="fa-solid fa-heart"></i>
              <span>贊助紀錄</span>
            </div>
            <div class="dropdown-divider"></div>
            <div class="dropdown-item logout" onclick="logout()">
              <i class="fa-solid fa-sign-out-alt"></i>
              <span>登出</span>
            </div>
          </div>
        </div>
        
        <!-- 音樂播放器 -->
        <audio id="backgroundMusic" preload="auto" autoplay>
          <source src="./source/music.mp3" type="audio/mpeg">
        </audio>
    </nav>

    <div class="mobile_navbar">
      <a href="https://www.sunrisemc.tw/#" class="mobile_navbar_logo_img_a"><img class="mobile_navbar_logo_img" src="./source/logo_small.png" alt="logo"></a>
      <div id="mobile_navbar_links">
        <a class="mobile_navbar_link" onclick="mobile_navbar_close()" href="https://wiki.sunrisemc.tw/" target="_blank"><i class="fa-solid fa-circle-info fa-fw"></i> Wiki</a>
        <a class="mobile_navbar_link" onclick="mobile_navbar_close()" href="https://discord.gg/3uEMfvv4d5" target="_blank"><i class="fa-brands fa-discord fa-fw"></i> Discord</a>
        <a class="mobile_navbar_link" onclick="mobile_navbar_close()" href="https://map.sunrisemc.tw/" target="_blank"><i class="fa-solid fa-location-dot fa-fw"></i> 地圖</a>
        <a class="mobile_navbar_link" onclick="mobile_navbar_close()" href="https://status.sunrisemc.tw/" target="_blank"><i class="fa-solid fa-toggle-on fa-fw"></i> 系統狀態</a>
        <a class="mobile_navbar_link scroll" onclick="mobile_navbar_close()" href="#about"><i class="fa-solid fa-user-nurse"></i> 成員</a>
        <a class="mobile_navbar_link scroll mobile_navbar_link2" onclick="mobile_navbar_close()" href="#join">立即加入!</a>
        <button class="mobile-theme-toggle" id="mobileThemeToggle" onclick="toggleTheme(); mobile_navbar_close();">
          <i class="fa-solid fa-sun" id="mobileSunIcon"></i>
          <span class="toggle-text" id="mobileToggleText">切換至黑色模式</span>
        </button>
        
        <!-- 手機版音量控制 -->
        <div class="mobile-volume-control">
          <div class="mobile-volume-header">
            <i class="fa-solid fa-volume-high"></i>
            <span>音量控制</span>
          </div>
          <div class="mobile-volume-slider-wrapper">
            <input type="range" class="mobile-volume-slider" id="mobileVolumeSlider" min="0" max="100" value="50">
          </div>
        </div>
      </div>

      <div class="mobile-user-container">
        <button class="avator" id="mobileUseravator">
          <img src="./source/loading.gif" alt="圖片" class="avator-img">
        </button>
        <!-- 手機版用戶下拉選單 -->
        <div class="mobile-user-dropdown" id="mobileUserDropdown">
          <div class="dropdown-item" onclick="showProfile(); mobile_navbar_close();">
            <i class="fa-solid fa-user"></i>
            <span>基本資料</span>
          </div>
          <div class="dropdown-item" onclick="showDonations(); mobile_navbar_close();">
            <i class="fa-solid fa-heart"></i>
            <span>贊助紀錄</span>
          </div>
          <div class="dropdown-divider"></div>
          <div class="dropdown-item logout" onclick="logout(); mobile_navbar_close();">
            <i class="fa-solid fa-sign-out-alt"></i>
            <span>登出</span>
          </div>
        </div>
      </div>

      <div class="icon" onclick="mobile_navbar_link_hider()">
        <i class="fa-solid fa-bars"></i>
      </div>
      <script>
        function mobile_navbar_link_hider() {
          var x = document.getElementById("mobile_navbar_links");
          // If already closing, ignore rapid toggles
          if (x.classList.contains('is-closing')) return;

          if (x.classList.contains('is-open')) {
            // Start closing animation
            x.classList.remove('is-open');
            x.classList.add('is-closing');

            // After animation ends, cleanup and hide
            const onAnimEnd = (e) => {
              if (e.target !== x) return; // ensure container event
              x.classList.remove('is-closing');
              x.removeEventListener('animationend', onAnimEnd);
            };
            x.addEventListener('animationend', onAnimEnd);
          } else {
            // Open with animation
            x.classList.add('is-open');
          }
        }
        // 僅關閉手機選單（不切換），避免在點擊需要關閉的操作時意外開啟
        function mobile_navbar_close() {
          var x = document.getElementById("mobile_navbar_links");
          if (x.classList.contains('is-open') && !x.classList.contains('is-closing')) {
            x.classList.remove('is-open');
            x.classList.add('is-closing');
            const onAnimEnd = (e) => {
              if (e.target !== x) return;
              x.classList.remove('is-closing');
              x.removeEventListener('animationend', onAnimEnd);
            };
            x.addEventListener('animationend', onAnimEnd);
          }
        }
      </script>
    </div>
    <div class="mainflex">
      <div class="main1">
        <a class="main1_logo_a" href="https://www.sunrisemc.tw/#">
          <img class="main1_logo" src="./source/logo.png" alt="logo">
        </a>
        <div class="main1_description">
          <a href="https://mcsv.top/server/sunrisemc.tw"><img src="https://sr-api.sfirew.com/server/sunrisemc.tw/banner/motd.png?hl=tw&v=icrxPMseQR" class="status"></a>
        </div>
        <div class="main1_player_stats">
          <div class="player_stat">
            <span class="stat_value" id="total-players">...</span>
            <span class="stat_label">位玩家曾加入</span>
          </div>
          <div class="player_stat">
            <span class="stat_value" id="claims">...</span>
            <span class="stat_label">個領地已建立</span>
          </div>
        </div>
        <div class="main1_ipcopier_div">
          <button class="main1_ipcopier" onclick="copyText()" type="button">
            <span class="main1_ipcopier_text1">sunrisemc.tw</span>
            <br>
            <span class="main1_ipcopier_text2">點我複製</span>
          </button>
          <script>
            console.log("被發現了...\n將此畫面截圖給管理員獲得日幣X1\n密碼: " + Math.floor(Math.random() * 1000000) + "\n每人限領一次，密碼限用一次")
            function copyText() {
                navigator.clipboard.writeText("sunrisemc.tw")
                  .then(function() {
                    Swal.fire({
                      title: "IP 複製成功",
                      icon: "success",
                      html: `<img alt="複製成功" src="./source/join.gif" class="joingif">`, 
                      confirmButtonText: `OK`,
                    });
                  })
                  .catch(function(err) {
                      setTimeout(() => {
                        copyText();
                      }, 500);
                  });
            }</script>
        </div>
        <a href="https://www.sunrisemc.tw/#more" class="scroll">
          <img alt="downarrow" class="main1_downarrow" src="./source/downarrow.png">
        </a>
        <script>
          const scrollLinks = document.querySelectorAll('.scroll');
          scrollLinks.forEach(function(link) {
            link.addEventListener('click', function(event) {
              event.preventDefault();
              const target = document.querySelector(link.getAttribute('href'));
              const offsetTop = target.offsetTop;
              window.scrollTo({
                top: offsetTop,
                behavior: 'smooth'
              });
            });
          });


        const url = new URLSearchParams(window.location.search);
        const copy = url.get('copy');
        if(copy != null) {
          copyText();
        }
        </script>
      </div>
      <div id="more"></div>
      <div class="main2">
        <a class="headline">我們的特色</a>
        <div class="main2_features_div">
          <div class="main2_feature">
            <img class="main2_feature_img" alt="Feature Image" src="./source/claim.png">
            <a class="main2_feature_headline">領地系統</a>
            <a class="main2_feature_text">保護建築不被破壞</a>
          </div>
          <div class="main2_feature">
            <img class="main2_feature_img" alt="Feature Image" src="./source/DC.png">
            <a class="main2_feature_headline">Discord連結</a>
            <a class="main2_feature_text">隨時隨地與伺服器玩家互動</a>
          </div>
          <div class="main2_feature">
            <img class="main2_feature_img" alt="Feature Image" src="./source/2ver.png">
            <a class="main2_feature_headline">雙版本聯通</a>
            <a class="main2_feature_text">無論你是Java還是基岩玩家都可以遊玩</a>
          </div>
          <div class="main2_feature">
            <img class="main2_feature_img" alt="Feature Image" src="./source/coin.png">
            <a class="main2_feature_headline">交易系統</a>
            <a class="main2_feature_text">讓您可以輕易兌換物資</a>
          </div>
          <div class="main2_feature">
            <img class="main2_feature_img" alt="Feature Image" src="./source/act.png">
            <a class="main2_feature_headline">活動</a>
            <a class="main2_feature_text">舉辦不定期活動</a>
          </div>
        </div>
      </div>
      <div id="about"></div>
      <div class="main5">
        <a class="headline">我們是誰?</a>

        <div class="main5_admin_div">
          <div class="main5_admins_div main5_admins_dev_type2">
            <img class="main5_admins_img" alt="admin member img" src="https://minotar.net/helm/GoogleDino_TW/600.png">
            <div class="main5_admins_description_div">
              <a class="main5_admins_description_rank main5_admins_description_rank_owner">服主</a>
              <a class="main5_admins_description_title">GoogleDino_TW - 臭腐竹</a>
              <a class="main5_admins_description">負責管理全部東西，有任何問題歡迎詢問</a>
            </div>
          </div>

          <div class="main5_admins_div main5_admins_dev_type1">
            <img class="main5_admins_img" alt="admin member img" src="https://minotar.net/helm/Easonlin1119/600.png">
            <div class="main5_admins_description_div">
              <a class="main5_admins_description_rank main5_admins_description_rank_admin">副服主</a>
              <a class="main5_admins_description_title">Easonlin1119 - 豬神</a>
              <a class="main5_admins_description">負責處理雜務</a>
            </div>
          </div>

          <div class="main5_admins_div main5_admins_dev_type1">
            <img class="main5_admins_img" alt="admin member img" src="https://minotar.net/helm/SisterCelia/600.png">
            <div class="main5_admins_description_div">
              <a class="main5_admins_description_rank main5_admins_description_rank_admin">管理員</a>
              <a class="main5_admins_description_title">SisterCelia - 不知名的小希</a>
              <a class="main5_admins_description">機器人維護、玩家糾紛處理</a>
            </div>
          </div>

          <div class="main5_admins_div main5_admins_dev_type1">
            <img class="main5_admins_img" alt="admin member img" src="https://minotar.net/helm/linchen180/600.png">
            <div class="main5_admins_description_div">
              <a class="main5_admins_description_rank main5_admins_description_rank_admin">管理員</a>
              <a class="main5_admins_description_title">linchen180 - 凌晨</a>
              <a class="main5_admins_description">玩家糾紛處理</a>
            </div>
          </div>

        </div>
      </div>
      <div id="join"></div>
      <div class="main3">
        <a class="headline">連線位置</a>
        <div class="main3_join_div_div">
          <div class="main3_join_div">
            <a class="main3_join_title">Java</a>
            <div class="main3_join_content_div">
              <div class="main3_join_categories">
                <a>IP:</a>
                <a>版本:</a>
              </div>
              <div class="main3_join_values">
                <a>sunrisemc.tw</a>
                <a>1.21.8，1.13以上可連線</a>
              </div>
            </div>
          </div>
          <div class="main3_join_div">
            <a class="main3_join_title">基岩</a>
            <div class="main3_join_content_div">
              <div class="main3_join_categories">
                <a>IP:</a>
                <a>Port:</a>
              </div>
              <div class="main3_join_values">
                <a>be.sunrisemc.tw</a>
                <a>19132 (預設)</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  
    <script>
      
      async function fetchPlayerStats() {
        try {
          const response = await fetch('https://api.sunrisemc.tw/info');
          const data = await response.json();
          
          const totalPlayers = data;

          let tempPlayers = 0;
          let tempClaims = 0;

          function updatePlayerCount() {
            tempPlayers += (1 - tempPlayers) / 7;
            document.getElementById('total-players').textContent = Math.ceil(totalPlayers[0] * tempPlayers);

            if (Math.ceil(totalPlayers[0] * tempPlayers) !== totalPlayers[0]) {
              setTimeout(updatePlayerCount, 50);
            }
          }

          function updateClaimCount() {
            tempClaims += (1 - tempClaims) / 7;
            document.getElementById('claims').textContent = Math.ceil(totalPlayers[1] * tempClaims);

            if (Math.ceil(totalPlayers[1] * tempClaims) !== totalPlayers[1]) {
              setTimeout(updateClaimCount, 50);
            }
          }

          updatePlayerCount()
          updateClaimCount()
        } catch (error) {
          console.error('Error fetching player stats:', error);
          document.getElementById('total-players').textContent = '1800+';
          document.getElementById('active-players').textContent = '1200+';
        }
      }

      fetchPlayerStats();
    </script>

    <!-- 黑色模式切換功能 -->
    <script>
      // Cookie helpers
      function setCookie(name, value, days) {
        const d = new Date();
        d.setTime(d.getTime() + (days*24*60*60*1000));
        const expires = "expires=" + d.toUTCString();
        document.cookie = name + "=" + encodeURIComponent(value) + ";" + expires + ";path=/";
      }

      function getCookie(name) {
        const cname = name + "=";
        const decodedCookie = decodeURIComponent(document.cookie);
        const ca = decodedCookie.split(';');
        for (let i = 0; i < ca.length; i++) {
          let c = ca[i].trim();
          if (c.indexOf(cname) === 0) {
            return c.substring(cname.length, c.length);
          }
        }
        return null;
      }

      function detectSystemTheme() {
        return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }

      function getSavedTheme() {
        const cookieTheme = getCookie('theme');
        if (cookieTheme) return cookieTheme;
        const lsTheme = localStorage.getItem('theme');
        return lsTheme || null;
      }

      let autoFollowSystem = false; // 若為 auto 或未設定，跟隨系統

      // 初始化主題
      function initTheme() {
        const saved = getSavedTheme();
        if (!saved || saved === 'auto') {
          autoFollowSystem = true;
          const systemTheme = detectSystemTheme();
          setTheme(systemTheme, { persist: false });
        } else {
          setTheme(saved);
        }

        // 系統主題變更時若為自動模式則跟隨
        if (window.matchMedia) {
          const mq = window.matchMedia('(prefers-color-scheme: dark)');
          mq.addEventListener('change', (e) => {
            if (autoFollowSystem) {
              setTheme(e.matches ? 'dark' : 'light', { persist: false });
            }
          });
        }
      }

      // 設置主題
      function setTheme(theme, options) {
        const opts = options || {};
        document.documentElement.setAttribute('data-theme', theme);
        if (!opts.persist === false) {
          localStorage.setItem('theme', theme);
          setCookie('theme', theme, 365);
        }
        // 一旦手動切換，停止自動跟隨
        if (!opts.auto) {
          autoFollowSystem = false;
        }
        
        // 更新桌面版切換按鈕
        const desktopToggle = document.getElementById('themeToggle');
        if (desktopToggle) {
          desktopToggle.setAttribute('data-theme', theme);
        }
        
        // 更新手機版切換按鈕
        const mobileSunIcon = document.getElementById('mobileSunIcon');
        const mobileToggleText = document.getElementById('mobileToggleText');
        
        if (mobileSunIcon && mobileToggleText) {
          if (theme === 'dark') {
            mobileSunIcon.className = 'fa-solid fa-moon';
            mobileToggleText.textContent = '切換至白色模式';
          } else {
            mobileSunIcon.className = 'fa-solid fa-sun';
            mobileToggleText.textContent = '切換至黑色模式';
          }
        }
      }

      // 切換主題
      function toggleTheme() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        setTheme(newTheme, { persist: true });
        
        // 添加切換動畫效果
        document.body.style.transition = 'all 0.3s ease';
        setTimeout(() => {
          document.body.style.transition = '';
        }, 300);
      }

      // 頁面載入時初始化主題
      document.addEventListener('DOMContentLoaded', function() {
        initTheme();
      });
    </script>

    <!-- Background Interactive JavaScript -->
    <script>
      class BackgroundInteractive {
        constructor() {
          this.container = document.getElementById('backgroundInteractive');
          this.mouseFollower = document.getElementById('mouseFollower');
          this.particles = [];
          this.mouseX = 0;
          this.mouseY = 0;
          this.isMouseMoving = false;
          this.mouseTimeout = null;
          
          this.init();
        }

        init() {
          this.createParticles();
          this.setupMouseTracking();
          this.setupParticleAnimation();
          this.setupEnergyRings();
        }

        createParticles() {
          const particleCount = 15;
          //console.log('創建粒子，數量:', particleCount);
          
          for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.className = 'floating-particle';
            
            // 隨機大小 (8px - 25px)
            const size = Math.random() * 17 + 8;
            particle.style.width = size + 'px';
            particle.style.height = size + 'px';
            
            // 隨機位置
            particle.style.left = Math.random() * 100 + '%';
            particle.style.top = Math.random() * 100 + '%';
            
            // 隨機動畫延遲
            particle.style.animationDelay = Math.random() * 8 * 1.1 + 's'; // 放慢10%
            
            this.container.appendChild(particle);
            this.particles.push(particle);
          }
          //console.log('粒子創建完成，實際創建數量:', this.particles.length);
        }

        setupMouseTracking() {
          document.addEventListener('mousemove', (e) => {
            this.mouseX = e.clientX;
            this.mouseY = e.clientY;
            this.isMouseMoving = true;
            
            // 更新滑鼠跟隨器位置

            this.mouseFollower.style.left = (this.mouseX - 10) + 'px';
            this.mouseFollower.style.top = (this.mouseY - 10) + 'px';
            this.mouseFollower.classList.add('active');
            
            // 清除之前的計時器
            clearTimeout(this.mouseTimeout);
            
            // 3秒後隱藏滑鼠跟隨器
            this.mouseTimeout = setTimeout(() => {
              this.mouseFollower.classList.remove('active');
              this.isMouseMoving = false;
            }, 3000);
            
            // 滑鼠互動效果：在滑鼠附近創建能量波紋
            this.createEnergyWave(this.mouseX, this.mouseY);
          });

          // 滑鼠離開頁面時隱藏跟隨器
          document.addEventListener('mouseleave', () => {
            this.mouseFollower.classList.remove('active');
            this.isMouseMoving = false;
          });
        }

        createEnergyWave(x, y) {
          // 每10次滑鼠移動才創建一次波紋，避免過度頻繁
          if (Math.random() > 0.9) {
            const wave = document.createElement('div');
            wave.style.position = 'absolute';
            wave.style.left = (x - 25) + 'px';
            wave.style.top = (y - 25) + 'px';
            wave.style.width = '50px';
            wave.style.height = '50px';
            wave.style.border = '2px solid var(--primary-orange-alpha)';
            wave.style.borderRadius = '50%';
            wave.style.pointerEvents = 'none';
            wave.style.animation = 'energyPulse 1s ease-out forwards';
            wave.style.opacity = '0.8';
            
            this.container.appendChild(wave);
            
            // 1秒後移除波紋元素
            setTimeout(() => {
              if (wave.parentNode) {
                wave.parentNode.removeChild(wave);
              }
            }, 1000);
          }
        }

        setupParticleAnimation() {
          // 定期更新粒子位置，增加隨機性
          setInterval(() => {
            this.particles.forEach((particle, index) => {
              if (Math.random() > 0.95) { // 5% 機率更新位置
                const newX = Math.random() * 100;
                const newY = Math.random() * 100;
                particle.style.left = newX + '%';
                particle.style.top = newY + '%';
              }
            });
          }, 2200); // 放慢約10%
        }

        setupEnergyRings() {
          // 為能量環添加動態效果
          const energyRings = document.querySelectorAll('.energy-ring');
          energyRings.forEach((ring, index) => {
            // 隨機調整動畫持續時間
            const duration = (4 + Math.random() * 4) * 1.1; // 放慢10%
            ring.style.animationDuration = duration + 's';
            
            // 定期改變位置
            setInterval(() => {
              if (Math.random() > 0.8) { // 20% 機率移動
                const newX = Math.random() * 80 + 10; // 10%-90%
                const newY = Math.random() * 80 + 10; // 10%-90%
                ring.style.left = newX + '%';
                ring.style.top = newY + '%';
              }
            }, (5000 + index * 1000) * 1.1); // 放慢10%
          });
        }

        // 響應式調整
        handleResize() {
          // 在視窗大小改變時重新計算粒子位置
          this.particles.forEach(particle => {
            const currentLeft = parseFloat(particle.style.left);
            const currentTop = parseFloat(particle.style.top);
            
            // 確保粒子不會超出視窗範圍
            if (currentLeft > 95) particle.style.left = '95%';
            if (currentTop > 95) particle.style.top = '95%';
          });
        }
      }

      // 初始化背景互動元件
      let backgroundInteractive;
      document.addEventListener('DOMContentLoaded', function() {
        //console.log('初始化背景互動元件...');
        backgroundInteractive = new BackgroundInteractive();
        //console.log('背景互動元件已初始化');
        
        // 響應式處理
        window.addEventListener('resize', () => {
          if (backgroundInteractive) {
            backgroundInteractive.handleResize();
          }
        });
      });

      // 性能優化：在頁面不可見時暫停動畫
      document.addEventListener('visibilitychange', () => {
        const particles = document.querySelectorAll('.floating-particle');
        const energyRings = document.querySelectorAll('.energy-ring');
        const holographicLines = document.querySelectorAll('.holographic-line');
        
        if (document.hidden) {
          // 暫停動畫
          [...particles, ...energyRings, ...holographicLines].forEach(element => {
            element.style.animationPlayState = 'paused';
          });
        } else {
          // 恢復動畫
          [...particles, ...energyRings, ...holographicLines].forEach(element => {
            element.style.animationPlayState = 'running';
          });
        }
      });
    </script>

    <!-- 音樂播放和音量控制功能 -->
    <script>
      class MusicPlayer {
        constructor() {
          this.audio = document.getElementById('backgroundMusic');
          this.volumeSlider = document.getElementById('volumeSlider');
          this.mobileVolumeSlider = document.getElementById('mobileVolumeSlider');
          this.volumeIcon = document.getElementById('volumeIcon');
          this.volumeToggle = document.getElementById('volumeToggle');
          // 移除對已刪除元素的引用
          
          this.isPlaying = false;
          this.volume = 0.5; // 預設50%音量
          this.retryInterval = null;
          this.fadeInterval = null;
          this.retryCount = 0;
          this.maxRetries = 100; // 最大重試次數
          
          this.init();
        }

        init() {
          // 設置初始音量
          this.audio.volume = this.volume;
          this.updateVolumeDisplay();
          this.updateVolumeSliderBackground();
          
          // 設置音樂事件監聽器
          this.setupAudioEvents();
          
          // 設置音量控制事件監聽器
          this.setupVolumeControls();
          
          // 自動播放音樂
          this.autoPlayMusic();
        }

        setupAudioEvents() {
          // 音樂結束時重新播放
          this.audio.addEventListener('ended', () => {
            //console.log('音樂播放結束，開始重播');
            this.audio.currentTime = 0;
            // 直接播放音樂，不需要淡入效果
            this.audio.play().then(() => {
              this.isPlaying = true;
              this.playWithFadeIn();
            }).catch(error => {
              console.error('重播失敗:', error);
              // 如果重播失敗，嘗試重新載入音樂
              this.audio.load();
              this.audio.play().then(() => {
                this.isPlaying = true;
                this.playWithFadeIn();
              }).catch(err => {
                console.error('重新載入後播放仍然失敗:', err);
              });
            });
          });

          // 音樂載入完成時
          this.audio.addEventListener('canplaythrough', () => {
            //console.log('音樂載入完成');
          });

          // 音樂播放錯誤處理
          this.audio.addEventListener('error', (e) => {
            console.error('音樂播放錯誤:', e);
            this.retryPlay();
          });

          // 音樂開始播放時
          this.audio.addEventListener('play', () => {
            this.isPlaying = true;
            //console.log('音樂開始播放');
          });

          // 音樂暫停時
          this.audio.addEventListener('pause', () => {
            this.isPlaying = false;
            //console.log('音樂暫停');
          });
        }

        setupVolumeControls() {
          // 桌面版音量滑塊
          this.volumeSlider.addEventListener('input', (e) => {
            this.setVolume(e.target.value / 100);
          });

          // 手機版音量滑塊
          this.mobileVolumeSlider.addEventListener('input', (e) => {
            this.setVolume(e.target.value / 100);
          });

          // 桌面版音量滑塊滾輪控制
          this.volumeSlider.addEventListener('wheel', (e) => {
            e.preventDefault();
            const delta = e.deltaY > 0 ? -5 : 5;
            const newValue = Math.max(0, Math.min(100, parseInt(this.volumeSlider.value) + delta));
            this.volumeSlider.value = newValue;
            this.setVolume(newValue / 100);
          });
        }

        setVolume(volume) {
          this.volume = Math.max(0, Math.min(1, volume));
          this.audio.volume = this.volume;
          this.updateVolumeDisplay();
          this.updateVolumeSliderBackground();
          
          // 更新音量圖示
          this.updateVolumeIcon();
        }

        updateVolumeDisplay() {
          const volumePercent = Math.round(this.volume * 100);
          this.volumeSlider.value = volumePercent;
          this.mobileVolumeSlider.value = volumePercent;
        }

        updateVolumeIcon() {
          if (this.volume === 0) {
            this.volumeIcon.className = 'fa-solid fa-volume-xmark';
          } else {
            this.volumeIcon.className = 'fa-solid fa-volume-high';
          }
          
          // 強制更新圖示
          this.volumeIcon.style.display = 'none';
          this.volumeIcon.offsetHeight; // 觸發重排
          this.volumeIcon.style.display = '';
        }

        updateVolumeSliderBackground() {
          const volumePercent = this.volume * 100;
          const gradient = `linear-gradient(to right, var(--primary-orange) 0%, var(--primary-orange) ${volumePercent}%, var(--background-tertiary) ${volumePercent}%, var(--background-tertiary) 100%)`;
          
          this.volumeSlider.style.background = gradient;
          this.mobileVolumeSlider.style.background = gradient;
        }

        async autoPlayMusic() {
          try {
            // 設置音量為0開始淡入
            this.audio.volume = 0;
            await this.audio.play();
            this.isPlaying = true;
            this.playWithFadeIn();
            //console.log('音樂自動播放成功');
            this.retryCount = 0; // 重置重試計數
          } catch (error) {
            //console.log('自動播放被阻擋，將每500ms重試:', error);
            this.retryPlay();
          }
        }

        async tryPlayMusic() {
          try {
            // 設置音量為0開始淡入
            this.audio.volume = 0;
            await this.audio.play();
            this.isPlaying = true;
            this.playWithFadeIn();
            //console.log('音樂開始播放');
            this.retryCount = 0; // 重置重試計數
          } catch (error) {
            c//onsole.log('播放被阻擋，將每500ms重試:', error);
            this.retryCount++;
            if (this.retryCount < this.maxRetries) {
              this.retryPlay();
            } else {
              //console.log('達到最大重試次數，停止重試');
            }
          }
        }

        retryPlay() {
          if (this.retryInterval) {
            clearInterval(this.retryInterval);
          }
          
          this.retryInterval = setInterval(async () => {
            try {
              await this.audio.play();
              this.isPlaying = true;
              this.playWithFadeIn();
              clearInterval(this.retryInterval);
              this.retryInterval = null;
              this.retryCount = 0; // 重置重試計數
              //console.log('音樂重試播放成功');
            } catch (error) {
              this.retryCount++;
              //console.log(`重試播放失敗 (${this.retryCount}/${this.maxRetries})，繼續重試...`);
            
            }
          }, 500);
        }

        playWithFadeIn() {
          if (this.fadeInterval) {
            clearInterval(this.fadeInterval);
          }
          
          let currentVolume = 0;
          const targetVolume = this.volume;
          const fadeStep = targetVolume / 50; // 2秒淡入
          
          this.fadeInterval = setInterval(() => {
            currentVolume = Math.min(targetVolume, currentVolume + fadeStep);
            this.audio.volume = currentVolume;
            
            if (currentVolume >= targetVolume) {
              clearInterval(this.fadeInterval);
              this.fadeInterval = null;
            }
          }, 40);
        }

        pauseWithFadeOut() {
          if (this.fadeInterval) {
            clearInterval(this.fadeInterval);
          }
          
          let currentVolume = this.audio.volume;
          const fadeStep = currentVolume / 25; // 1秒淡出
          
          this.fadeInterval = setInterval(() => {
            currentVolume = Math.max(0, currentVolume - fadeStep);
            this.audio.volume = currentVolume;
            
            if (currentVolume <= 0) {
              clearInterval(this.fadeInterval);
              this.fadeInterval = null;
              this.audio.pause();
              this.isPlaying = false;
            }
          }, 40);
        }
      }

      // 音量控制顯示/隱藏功能 - 已移除，現在使用CSS hover效果

      // 初始化音樂播放器
      let musicPlayer;
      document.addEventListener('DOMContentLoaded', function() {
        musicPlayer = new MusicPlayer();
        
        // 頁面載入完成後再次嘗試播放音樂
        setTimeout(() => {
          if (musicPlayer && !musicPlayer.isPlaying) {
            musicPlayer.autoPlayMusic();
          }
        }, 1000);

        // 製造假的使用者互動來觸發音樂播放
        setTimeout(() => {
          // 模擬點擊事件
          const fakeClickEvent = new MouseEvent('click', {
            view: window,
            bubbles: true,
            cancelable: true
          });
          document.dispatchEvent(fakeClickEvent);
          
          // 模擬觸摸事件
          const fakeTouchEvent = new TouchEvent('touchstart', {
            bubbles: true,
            cancelable: true
          });
          document.dispatchEvent(fakeTouchEvent);
          
          // 模擬鍵盤事件
          const fakeKeyEvent = new KeyboardEvent('keydown', {
            key: ' ',
            bubbles: true,
            cancelable: true
          });
          document.dispatchEvent(fakeKeyEvent);
          
          //console.log('已觸發假的使用者互動事件');
        }, 2000);
      });

      // 頁面可見性變化時處理音樂播放
      document.addEventListener('visibilitychange', () => {
        if (musicPlayer) {
          if (document.hidden) {
            // 頁面隱藏時淡出音樂
            musicPlayer.pauseWithFadeOut();
          } else {
            // 頁面顯示時淡入音樂
            if (musicPlayer.isPlaying) {
              musicPlayer.playWithFadeIn();
            } else {
              musicPlayer.autoPlayMusic();
            }
          }
        }
      });

      // 用戶互動後嘗試播放音樂
      document.addEventListener('click', function() {
        if (musicPlayer && !musicPlayer.isPlaying) {
          musicPlayer.autoPlayMusic();
        }
      }, { once: true });

      document.addEventListener('touchstart', function() {
        if (musicPlayer && !musicPlayer.isPlaying) {
          musicPlayer.autoPlayMusic();
        }
      }, { once: true });
    </script>

    <script>
      // 用戶下拉選單功能
      class UserDropdown {
        constructor() {
          this.desktopAvatar = document.getElementById('useravator');
          this.mobileAvatar = document.getElementById('mobileUseravator');
          this.desktopDropdown = document.getElementById('userDropdown');
          this.mobileDropdown = document.getElementById('mobileUserDropdown');
          this.mobileMenu = document.getElementById('mobile_navbar_links');
          
          this.init();
        }

        init() {
          // 桌面版頭像點擊事件
          if (this.desktopAvatar) {
            this.desktopAvatar.addEventListener('click', (e) => {
              e.stopPropagation();
              this.toggleDesktopDropdown();
            });
          }

          // 手機版頭像點擊事件
          if (this.mobileAvatar) {
            this.mobileAvatar.addEventListener('click', (e) => {
              e.stopPropagation();
              this.toggleMobileDropdown();
            });
          }

          // 手機版選單按鈕點擊事件
          const mobileMenuButton = document.querySelector('.mobile_navbar .icon');
          if (mobileMenuButton) {
            mobileMenuButton.addEventListener('click', () => {
              this.closeMobileDropdown();
            });
          }
        }

        toggleDesktopDropdown() {
          if (this.desktopDropdown) {
            const isOpen = this.desktopDropdown.classList.contains('show');
            this.closeAllDropdowns();
            if (!isOpen) {
              this.desktopDropdown.classList.add('show');
            }
          }
        }

        toggleMobileDropdown() {
          if (this.mobileDropdown) {
            const isOpen = this.mobileDropdown.classList.contains('show');
            this.closeAllDropdowns();
            if (!isOpen) {
              this.mobileDropdown.classList.add('show');
            }
          }
        }

        closeDesktopDropdown() {
          if (this.desktopDropdown) {
            this.desktopDropdown.classList.remove('show');
          }
        }

        closeMobileDropdown() {
          if (this.mobileDropdown) {
            this.mobileDropdown.classList.remove('show');
          }
        }

        closeAllDropdowns() {
          this.closeDesktopDropdown();
          this.closeMobileDropdown();
        }

        // 檢查手機版選單是否開啟
        isMobileMenuOpen() {
          return this.mobileMenu && this.mobileMenu.classList.contains('is-open');
        }

        // 關閉手機版選單
        closeMobileMenu() {
          if (this.mobileMenu && this.isMobileMenuOpen()) {
            this.mobileMenu.classList.remove('is-open');
            this.mobileMenu.classList.add('is-closing');
            
            const onAnimEnd = (e) => {
              if (e.target !== this.mobileMenu) return;
              this.mobileMenu.classList.remove('is-closing');
              this.mobileMenu.removeEventListener('animationend', onAnimEnd);
            };
            this.mobileMenu.addEventListener('animationend', onAnimEnd);
          }
        }
      }

      // 模態窗口管理類
      class ModalManager {
        constructor() {
          this.overlay = document.getElementById('modalOverlay');
          this.activeModal = null;
          this.isAnimating = false;
          this.init();
        }

        init() {
          // 點擊背景關閉模態窗口
          if (this.overlay) {
            this.overlay.addEventListener('click', (e) => {
              if (e.target === this.overlay) {
                this.closeAllModals();
              }
            });
          }

          // ESC鍵關閉模態窗口
          document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && this.activeModal) {
              this.closeAllModals();
            }
          });
        }

        showModal(modalId) {
          const modal = document.getElementById(modalId);
          if (modal && this.overlay && !this.isAnimating) {
            // 先確保所有模態窗口都隱藏
            this.hideAllModals();
            
            // 然後打開指定的模態窗口
            this.openModal(modalId);
          }
        }

        hideAllModals() {
          const modals = this.overlay.querySelectorAll('.modal');
          modals.forEach(modal => {
            modal.style.display = 'none';
          });
        }

        openModal(modalId) {
          const modal = document.getElementById(modalId);
          if (modal && this.overlay) {
            this.isAnimating = true;
            this.activeModal = modalId;
            this.overlay.classList.add('show');
            modal.style.display = 'block';
            
            // 防止背景滾動
            document.body.style.overflow = 'hidden';
            // 標記 Body 狀態，讓 CSS 能即時隱藏手機選單以避免同時顯示
            document.body.classList.add('modal-open');
            
            // 關閉所有下拉選單
            if (userDropdown) {
              userDropdown.closeAllDropdowns();
              // 同時關閉手機版選單，避免與模態視窗同時顯示
              userDropdown.closeMobileMenu();
            }
            
            // 動畫完成後重置狀態
            setTimeout(() => {
              this.isAnimating = false;
            }, 300);
          }
        }

        closeModal(modalId) {
          const modal = document.getElementById(modalId);
          if (modal && this.overlay) {
            this.animateClose();
          }
        }

        closeAllModals() {
          if (this.overlay) {
            this.animateClose();
          }
        }

        animateClose() {
          if (this.overlay && !this.isAnimating) {
            this.isAnimating = true;
            
            // 添加關閉動畫類
            this.overlay.classList.remove('show');
            this.overlay.classList.add('closing');
            // 在關閉過程中持續隱藏手機選單
            document.body.classList.add('modal-closing');
            
            const onAnimEnd = (e) => {
              if (e.target !== this.overlay) return;
              this.overlay.removeEventListener('animationend', onAnimEnd);
              this.overlay.classList.remove('closing');
              const modals = this.overlay.querySelectorAll('.modal');
              modals.forEach(modal => {
                modal.style.display = 'none';
              });
              this.activeModal = null;
              this.isAnimating = false;

              // 恢復背景滾動並移除狀態類
              document.body.style.overflow = '';
              document.body.classList.remove('modal-open');
              document.body.classList.remove('modal-closing');
            };
            // 使用動畫結束事件避免時間誤差
            this.overlay.addEventListener('animationend', onAnimEnd);
            // 退場保險：若事件丟失，於300ms後強制清理
            setTimeout(() => {
              if (this.isAnimating) {
                onAnimEnd({ target: this.overlay });
              }
            }, 300);
          }
        }
      }

      // 用戶功能函數
      function showProfile() {
        if (modalManager) {
          modalManager.showModal('profileModal');
        }
      }

      function showDonations() {
        if (modalManager) {
          modalManager.showModal('donationsModal');
        }
      }

      function closeModal(modalId) {
        if (modalManager) {
          modalManager.closeModal(modalId);
        }
      }

      // 複製到剪貼板功能
      function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
          // 顯示複製成功提示
          const toast = document.createElement('div');
          toast.className = 'copy-toast';
          toast.textContent = '已複製到剪貼板';
          toast.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-orange);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: var(--roundness-small);
            box-shadow: var(--shadow-medium);
            z-index: 10000;
            font-weight: 500;
            animation: slideInRight 0.3s ease-out;
          `;
          
          document.body.appendChild(toast);
          
          // 3秒後移除提示
          setTimeout(() => {
            toast.style.animation = 'slideOutRight 0.3s ease-in forwards';
            setTimeout(() => {
              if (toast.parentNode) {
                toast.parentNode.removeChild(toast);
              }
            }, 300);
          }, 3000);
        }).catch(err => {
          console.error('複製失敗:', err);
          // 降級方案：使用舊的複製方法
          const textArea = document.createElement('textarea');
          textArea.value = text;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          
          alert('已複製到剪貼板');
        });
      }

      function logout() {
        document.querySelector('.user-container').innerHTML = '<a href="/login" class="avator-img"><i class="fa-solid fa-right-to-bracket"></i></a>'
        document.querySelector('.mobile-user-container').innerHTML = '<a href="/login" class="avator-img"><i class="fa-solid fa-right-to-bracket"></i></a>'
        localStorage.removeItem("token");
      }

      // 初始化用戶下拉選單和模態窗口管理器
      let userDropdown;
      let modalManager;
      document.addEventListener('DOMContentLoaded', function() {
        userDropdown = new UserDropdown();
        modalManager = new ModalManager();
      });

      // 修改原有的手機版選單函數，添加與用戶下拉選單的互斥邏輯
      const originalMobileNavbarLinkHider = window.mobile_navbar_link_hider;
      window.mobile_navbar_link_hider = function() {
        // 如果用戶下拉選單開啟，先關閉它
        if (userDropdown) {
          userDropdown.closeMobileDropdown();
        }
        // 執行原有的選單切換邏輯
        if (originalMobileNavbarLinkHider) {
          originalMobileNavbarLinkHider();
        }
      };
    </script>

    <script>
      const token = localStorage.getItem("token");
      async function check() {
        if(token) {
          const check = await fetch('https://account.sunrisemc.tw/check/?token=' + token);
          const info = await check.json()

          //console.log(info);
          if (info['linked']) {
            document.querySelector('#player-id').innerHTML = info['name'];
            document.querySelector('#player-uuid').innerHTML = info['uuid'];
            document.querySelector('#discord-id').innerHTML = info['discord'];

            document.querySelectorAll('.avator-img').forEach(img => {
                img.src = 'https://minotar.net/helm/' + info['name'] + '/600.png';
            });
            document.querySelector('.profile-avatar-img').src = 'https://minotar.net/helm/' + info['name'] + '/600.png';

            let totalMoney = 0;
            if(info['history'].length > 0) {
              info['history'].forEach(e => {
                document.querySelector('#donate-sheet').innerHTML += `
                <tr>
                  <td>${e[0]}</td>
                  <td class="amount">${e[1]}</td>
                  <td class="item">${e[2]}</td>
                  <td class="message">${e[3]}</td>
                </tr>
                `
                totalMoney += parseInt(e[1]);
              });
            }
            document.querySelector('#total-money').innerHTML = `NT$ ${totalMoney}`
            document.querySelector('#total-count').innerHTML = `${info['history'].length} 次`
          } else {
            document.querySelector('.user-container').innerHTML = '<a href="/login" class="avator-img"><i class="fa-solid fa-right-to-bracket"></i></a>'
            document.querySelector('.mobile-user-container').innerHTML = '<a href="/login" class="avator-img"><i class="fa-solid fa-right-to-bracket"></i></a>'
            localStorage.removeItem("token");
            Swal.fire({
              icon: "error",
              title: "登入失敗",
              text: "原因：該Discord帳戶尚未連結至Minecraft帳號，請連結後重新登入！",
              footer: '<a href="https://wiki.sunrisemc.tw/jia-ru-wo-men/lian-jie-discord" target="_blank">連結教學</a>'
            });
          }
        } else {
          document.querySelector('.user-container').innerHTML = '<a href="/login" class="avator-img"><i class="fa-solid fa-right-to-bracket"></i></a>'
          document.querySelector('.mobile-user-container').innerHTML = '<a href="/login" class="avator-img"><i class="fa-solid fa-right-to-bracket"></i></a>'
        }
      }
      check()
    </script>

    <!-- 模態窗口容器 -->
    <div class="modal-overlay" id="modalOverlay">
      <!-- 基本資訊模態窗口 -->
      <div class="modal" id="profileModal">
        <div class="modal-header">
          <h2 class="modal-title">基本資訊</h2>
          <button class="modal-close" onclick="closeModal('profileModal')">
            <i class="fa-solid fa-times"></i>
          </button>
        </div>
        <div class="modal-content">
          <div class="profile-info">
            <div class="profile-avatar">
              <img src="./source/loading.gif" alt="玩家頭像" class="profile-avatar-img">
            </div>
            <div class="profile-details">
              <div class="profile-item">
                <label class="profile-label">玩家名稱</label>
                <span class="profile-value" id="player-id">...</span>
              </div>
              <div class="profile-item">
                <label class="profile-label">UUID</label>
                <span class="profile-value uuid" id="player-uuid">...</span>
              </div>
              <div class="profile-item">
                <label class="profile-label">Discord ID</label>
                <span class="profile-value" id="discord-id">...</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 贊助紀錄模態窗口 -->
      <div class="modal" id="donationsModal">
        <div class="modal-header">
          <h2 class="modal-title">贊助紀錄</h2>
          <button class="modal-close" onclick="closeModal('donationsModal')">
            <i class="fa-solid fa-times"></i>
          </button>
        </div>
        <div class="modal-content">
          <div class="donations-container">
            <div class="donations-summary">
              <div class="summary-item">
                <span class="summary-label">總贊助金額</span>
                <span class="summary-value" id="total-money">...</span>
              </div>
              <div class="summary-item">
                <span class="summary-label">贊助次數</span>
                <span class="summary-value" id="total-count">...</span>
              </div>
            </div>
            <div class="donations-table-container">
              <table class="donations-table">
                <thead>
                  <tr>
                    <th>贊助時間</th>
                    <th>贊助金額</th>
                    <th>贊助項目</th>
                    <th>贊助感言</th>
                  </tr>
                </thead>
                <tbody id="donate-sheet">
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
</body>
<footer class="copyright_div">
  <div class="copyright">日出伺服器 - Minecraft生存伺服器最佳選擇</div>
</footer>
</html>